(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{727:function(e,t,n){},772:function(e,t,n){"use strict";n(10),n(8),n(7),n(9),n(23),n(50),n(51),n(5),n(272),n(19),n(21);var r=n(14),o=(n(33),n(1)),l=(n(727),n(18)),d=n.n(l),c=n(58),f=n(3),h=n(27),y=n.n(h),m=n(82),v=n(13);function D(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,n)}return t}function k(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?D(Object(source),!0).forEach((function(t){Object(o.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):D(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var S={mixins:[Object(c.a)("rental",{fields:["slotLength"]})],components:{dwAlert:m.a,dwIcon:v.a},props:{mode:{type:String,default:"single",validator:function(e){return"range"===e||"single"===e}},userName:{type:String},value:{type:Object},innerFormat:{type:String,default:"d-m-Y"},inline:{type:Boolean,default:!1},isRentalCalendar:{type:Boolean,default:!1},timezone:{type:String,default:"Pacific/Auckland"},disabledDates:{type:Array},disabledWeekdays:Array,disabledCalendar:{type:Boolean,default:!1},hideInput:{type:Boolean,default:!0},minDate:{type:[String,Date],validator:function(e){return"string"==typeof e||e instanceof Date},default:function(){return d()().startOf("day").toDate()}},maxDate:{type:[String,Date],validator:function(e){return"string"==typeof e||e instanceof Date},default:function(){return d()().startOf("day").add(6,"months").toDate()}},listing:{type:Object}},data:function(){return{currentSlotLength:null,localInnerValueChange:!1,innerValue:[],mounted:!1,config:this.getFlatpickrConfig(),weekendConfirmation:!1,readyToClick:!1,showWarningMessage:!1}},computed:k(k(k(k(k(k(k({},Object(f.c)("ui",["isMobile"])),Object(f.c)("date-selector",["tooltip"])),Object(f.b)("rental",["disabledDated","bookedSlots","bookedBufferDates","rentalBuffers"])),Object(f.c)("rental",["loadingEdit","RENTAL_CLOSING_HOUR_WEEKDAY"])),Object(f.c)("rental",{selectedSlot:function(e){return e.form.selectedSlot}})),Object(f.b)("settings",["settingBlockDates"])),{},{parsedSlotLength:function(){return parseInt(this.slotLength)},cognitoUrl:function(){return'https://www.cognitoforms.com/DesignerWardrobe1/RentalInquiry?entry={"ListingID":"'.concat(this.listing.id,'","ListingTitle":"').concat(this.listing.title,'","EventDate":"').concat(this.$el.querySelectorAll(".flatpickr-input")[0]._flatpickr.selectedDates[0].toISOString().split("T")[0],'"}')}}),watch:{disabledDated:function(){var e=this,t=this.$el.querySelectorAll(".flatpickr-input")[0]._flatpickr,n=this.getDisabledDates();this.config.disable=Object(r.a)(n),t.config.disable=Object(r.a)(n),t.clear(),setTimeout((function(){e.hoverOnDayHandler()}),100)},innerValue:function(e,t){var n=this;if(!this.disabledCalendar&&(this.readyToClick||this.isMobile)){var r=this.$el.querySelectorAll(".flatpickr-input")[0]._flatpickr,o=r.selectedDates;if(this.$store.commit("rental/SET_RENTAL_STARTS_AT_WEEKEND",!1),this.isMobile)if(!this.isRentalCalendar&&this.checkWeekendsHooverIsBlocked(o))return r.clear(),r.selectedDates=[],r.setDate([],!1),void setTimeout((function(){n.hoverOnDayHandler()}));var l=this.checkWeekends(o,r),d=l;if(!this.isRentalCalendar&&d&&0!==d.length&&((d=this.checkValidBuffer(l))&&0!==d.length||(this.showWarningMessage=!0,setTimeout((function(){n.showWarningMessage=!1}),1e4))),this.checkUrgentDelivery(o,r),d.length&&!this.localInnerValueChange){var c=this.formatSelectedSlot(d);this.$emit("input",{dates:c}),this.$emit("onClose")}}},slotLength:function(e){var t=this;this.$el.querySelector(".flatpickr-input")._flatpickr.clear(),setTimeout((function(){t.hoverOnDayHandler()}))},tooltip:function(e){e?this.addTooltip(e):this.removeTooltip()}},methods:{findIfRentalIsClosedToday:function(){return parseInt(d()().format("HHmm"))>this.RENTAL_CLOSING_HOUR_WEEKDAY},findIfIsFridayAfterHoursToday:function(){return 5===d()().day()&&this.findIfRentalIsClosedToday()},findIfDateIsCurrentWeekend:function(e){return[0,6].includes(e.getDay())&&d()(e).diff(d()(),"days")<3},findIfIsWeekend:function(e){var t=new Date(e);return 0===t.getDay()||6===t.getDay()},findIfBlockedByUser:function(e){return this.disabledDates.findIndex((function(t){return t.toString()===e.toString()}))},findIfIsValidBooking:function(e){for(var t=!0,n=d()(e[0]).startOf("day"),r=d()(e[1]).startOf("day"),i=0;i<this.disabledDates.length;i++)if(d()(this.disabledDates[i]).startOf("day").isBetween(n,r,null,"[]")){t=!1;break}return t},getDisabledDates:function(){var e=y()(this.disabledDates)||[],t=y()(this.disabledWeekdays)||[];return e.push((function(e){return t.indexOf(e.getDay())>-1})),e},isStartDateDisabled:function(e){var t=!1;if(!e||0===e.length)return!1;var n=e[0];return this.settingBlockDates.find((function(e){return e.toString()===n.toString()}))&&(t=!0),t},isRangeDisabled:function(e){var t=this,n=!1;return e.forEach((function(r,o){var l=t.disabledDates.find((function(e){return e.toString()===r.toString()})),c=t.disabledWeekdays&&t.disabledWeekdays.indexOf(r.getDay())>-1,f=d()(r).isBefore(d()(),"day");if(l||f)n=!0;else{if(c){var h=0===o,y=o===e.length-1;if(h||y)return void(n=!0)}if(0===o)if(t.settingBlockDates.find((function(e){return e.toString()===r.toString()})))return void(n=!0)}})),n},prepareHoover:function(e,t){return t},getCurrentSlotLength:function(e){var t=this.parsedSlotLength,n=new Date(e).getDay();return this.prepareHoover(n,t)},daySiblingActionOnEvent:function(e){var t=e.eventName,element=e.element,n=e.onSiblings,r=this;element.addEventListener(t,(function(){var e,t=[this];r.currentSlotLength=r.getCurrentSlotLength(element.dateObj);for(var i=0;i<r.currentSlotLength-1;i++)e||(e=element.nextSibling),e&&(t.push(e),e=e.nextSibling);n(t)}))},hoverOnDayHandler:function(){var e=this;this.isMobile&&this.isRentalCalendar&&this.$el.querySelectorAll(".flatpickr-day").forEach((function(t){e.daySiblingActionOnEvent({eventName:"click",element:t,onSiblings:function(t){var n=t.map((function(element){return element.dateObj}));t.forEach((function(element){e.findIfBlockedByUser.apply(e,Object(r.a)(n))>-1&&(element.classList.add("selected"),e.$emit("mobileUpdate",n))}))}})}));this.isMobile||this.$el.querySelectorAll(".flatpickr-day").forEach((function(t){t.addEventListener("mouseenter",(function(){var text=e.checkShowTooltip(t.dateObj);text&&e.$emit("on-day-mouse-enter",{element:t,text:text})})),t.addEventListener("mouseout",(function(){e.checkShowTooltip(t.dateObj)&&e.$emit("on-day-mouse-out",{element:t})})),e.daySiblingActionOnEvent({eventName:"mouseenter",element:t,onSiblings:function(t){e.readyToClick||(e.readyToClick=!0);var n=t.map((function(element){return element.dateObj})),o=e.isRangeDisabled(n),l=e.isRentalCalendar?e.findIfBlockedByUser.apply(e,Object(r.a)(n)):null,d=e.isRentalCalendar?"rentals"===e.userName?null:e.findIfIsWeekend.apply(e,Object(r.a)(n)):null,c=!e.isRentalCalendar&&e.checkWeekendsHooverIsBlocked(n);t.forEach((function(element,n){var r=0===n,f=n===t.length-1;r&&element.classList.add("js-startRange"),f&&element.classList.add("js-endRange"),o?element.classList.contains("disabled")||element.classList.add("js-disabled"):element.classList.add("js-hovered"),element.classList.add("js-slot"),c&&element.classList.add("js-disabled","disabled"),null===l||-1===l||d||(e.removeDateByIndex(l),element.classList.add("allow-unblocked-date"),element.classList.remove("js-hovered","js-disabled","js-slot","js-startRange","js-endRange","disabled"))}))}}),e.daySiblingActionOnEvent({eventName:"mouseleave",element:t,onSiblings:function(t){var n=t.map((function(element){return element.dateObj})),o=e.isRentalCalendar?e.findIfBlockedByUser.apply(e,Object(r.a)(n)):null,l=!e.isRentalCalendar&&e.checkWeekendsHooverIsBlocked(n),d=e.isRentalCalendar?"rentals"===e.userName?null:e.findIfIsWeekend.apply(e,Object(r.a)(n)):null;t.forEach((function(element){if(element.classList.remove("js-hovered","js-disabled","js-slot","js-startRange","js-endRange","allow-unblocked-date","disabled-weekends"),l){element.classList.remove("js-disabled");var t=e.findIfBlockedByUser(element.dateObj),n=Date.parse(element.dateObj)-Date.parse(new Date);-1===t&&n>0&&element.classList.remove("disabled")}null===o||-1===o||d||(e.pushDateByIndex(o),element.classList.add("disabled"))}))}})}));this.disabledCalendar&&this.disableCalendarCells(),this.isRentalCalendar&&(this.styleBufferDays(),this.showBorrowerOnBlockedDays())},checkShowTooltip:function(e){var t=this.findIfBlockedByUser(e),time=new Date(e).getTime(),n=new Date(this.minDate).getTime();return-1!==t||time<n?"Unavailable":this.settingBlockDates.find((function(t){return t.toString()===e.toString()}))?"Not available as starting date":null},checkWeekendsHooverIsBlocked:function(e){return!1},removeDateByIndex:function(e){var t=this.getDisabledDates();t=t.filter((function(n){return n.toString()!==t[e].toString()})),this.updateBlockedDatesInstance(t)},pushDateByIndex:function(e){var t=this.getDisabledDates(),n=t.find((function(n){return n.toString()===t[e].toString()}));t.push(n),this.updateBlockedDatesInstance(t)},updateBlockedDatesInstance:function(e){var t=this,n=this.$el.querySelectorAll(".flatpickr-input")[0]._flatpickr;this.config.disable=Object(r.a)(e),n.config.disable=Object(r.a)(e),n.clear(),setTimeout((function(){t.hoverOnDayHandler()}),100)},getFlatpickrConfig:function(){var e=this;return{dateFormat:this.innerFormat,mode:this.mode,inline:this.inline,nextArrow:'<svg><use xlink:href="/images/sprites.svg#triangle-right"/></svg>',prevArrow:'<svg><use xlink:href="/images/sprites.svg#triangle-left"/></svg>',appendTo:this.$el,disable:this.getDisabledDates(),minDate:this.minDate,maxDate:this.maxDate,onReady:function(t,n,r){r.clear(),setTimeout((function(){if(e.hideInput){var input=e.$el.querySelectorAll("input.flatpickr-input")[0];input&&(input.style.display="none")}("range"===e.mode||e.isRentalCalendar)&&e.parsedSlotLength&&e.hoverOnDayHandler()}))},onChange:function(t,n,r){var o=!e.isRentalCalendar&&e.checkWeekendsHooverIsBlocked(t);if("range"===e.mode&&e.parsedSlotLength){if(1===t.length){var l=t[0];e.isMobile&&(e.currentSlotLength=e.getCurrentSlotLength(l));var c=Array.apply(null,Array(e.currentSlotLength||e.parsedSlotLength)).map((function(e,t){return d()(l).add(t,"days").toDate()})),f=[c[0],c[c.length-1]];if(e.isRangeDisabled(c)||o){if(e.isMobile&&e.isStartDateDisabled(c)){var h=d()(c[0]).format("MMMM D, YYYY");e.$store.commit("date-selector/ADD_TOOLTIP",{text:"Not available as starting date",targetSelector:'[aria-label="'.concat(h,'"]')}),setTimeout((function(){e.$store.commit("date-selector/REMOVE_TOOLTIP",{targetSelector:'[aria-label="'.concat(h,'"]')})}),3e3)}return r.clear(),void setTimeout((function(){e.hoverOnDayHandler()}))}if(r.setDate(f,!1),!e.isRentalCalendar&&l&&e.innerValue&&e.isClickOnStartRange(l,e.innerValue)){var y=e.checkValidBuffer(f);y&&0!==y.length||(e.showWarningMessage=!0,setTimeout((function(){e.showWarningMessage=!1}),1e4)),y.length&&e.$emit("onClose")}}t.length>0&&setTimeout((function(){e.hoverOnDayHandler()}))}},onMonthChange:function(){setTimeout((function(){e.hoverOnDayHandler(),e.styleCurrentWeekendDays()}))},onYearChange:function(){setTimeout((function(){e.hoverOnDayHandler()}))}}},createTooltip:function(e){var text=e.text,t=e.constant,n=e.className,r=document.createElement("div");return r.className="date-tooltip ".concat(t?"":"js-date-tooltip"," ").concat(n),r.innerHTML='\n        <div class="date-tooltip__content">'.concat(text,'</div>\n        <div class="date-tooltip__arrow"></div>\n      '),r},addTooltip:function(e){var text=e.text,t=e.targetSelector,n=this.createTooltip({text:text});this.$el.querySelector(t).appendChild(n)},removeTooltip:function(){this.$el.querySelector(".flatpickr-days").querySelectorAll(".js-date-tooltip").forEach((function(e){return e.remove()}))},getNextDay:function(e,t){return new Date(e.getTime()+864e5*t)},getPreviosDay:function(e,t){return new Date(e-864e5*t)},openConfirmModal:function(e){this.$store.commit("modal/SHOW_MODAL",{modalName:e})},checkUrgentDelivery:function(e,t){var n=new Date(e.slice().shift()),r=d()(new Date).add(1,"days");d()(n).isSame(r,"day")&&this.findIfRentalIsClosedToday()&&!this.findIfIsFridayAfterHoursToday()&&!this.findIfDateIsCurrentWeekend(n)&&this.openConfirmModal("UrgentCalendar")},formatSelectedSlot:function(e){return Array.apply(null,Array(this.currentSlotLength||this.parsedSlotLength)).map((function(t,n){return d()(e[0]).add(n,"days").toDate()}))},changeDeliveryToThursdayOrFriday:function(e,t,n){var r=new Date(e.slice().shift()),o=new Date(e.slice().pop()),l=0,d=0,c="";if(this.$store.commit("rental/SET_RENTAL_STARTS_AT_WEEKEND",!1),6===r.getDay()){var f=this.findIfBlockedByUser(this.getPreviosDay(r,1));if(l=1,d=1,c="message-confirm-calendar-Friday",null!==f&&-1!==f)return this.$store.commit("rental/CLEAR_SELECTED_SLOT"),this.$store.commit("modal/SHOW_MODAL",{modalName:"booking"}),!1}else if(0===r.getDay()){var h=this.findIfBlockedByUser(this.getPreviosDay(r,2));if(l=2,d=2,c="message-confirm-calendar-Friday",null!==h&&-1!==h)return this.$store.commit("rental/CLEAR_SELECTED_SLOT"),this.$store.commit("modal/SHOW_MODAL",{modalName:"booking"}),!1}return n||this.openConfirmModal(c),e[0]=this.getPreviosDay(r,l),e[1]=this.getPreviosDay(o,d),this.currentSlotLength=4,this.formatSelectedSlot(e)},checkWeekends:function(e,t){var n=this,r=new Date(e.slice().shift()),o=new Date,l=t.config.minDate;return this.isRentalCalendar||("rentals"!==this.userName?this.changeDeliveryToThursdayOrFriday(e,l,!1):(this.findIfIsWeekend(o)||this.findIfIsFridayAfterHoursToday())&&this.findIfDateIsCurrentWeekend(r)?(this.openConfirmModal("RentForCurrentWeekend"),this.$store.commit("rental/SET_RENTAL_STARTS_AT_WEEKEND",!0)):this.findIfIsWeekend(r)&&(this.$store.commit("rental/SET_RENTAL_STARTS_AT_WEEKEND",!0),this.$store.commit("modal/SHOW_MODAL",{modalName:"RentForForthcomingWeekend",modalData:{changeDeliveryToThursdayOrFriday:function(){return n.changeDeliveryToThursdayOrFriday(e,l,!0)}}}))),e},checkValidBuffer:function(e){var t=new Date(e.slice().shift()),n=new Date(e.slice().pop());if(this.rentalBuffers&&7===this.rentalBuffers.length){var r=parseInt(this.rentalBuffers[t.getDay()]);if(!isNaN(r))if(!this.findIfIsValidBooking([t,this.getNextDay(n,r)]))return!1}return e},styleCurrentWeekendDays:function(){var e=this;if("rentals"===this.userName){var t=d()();setTimeout((function(){var n=function(t,n){if(t&&!t.classList.contains("disabled")){var r=e.createTooltip({text:"Auckland store pickup only",constant:!0,className:"store-tooltip"});t.appendChild(r)}},r=function(t){return e.$el.querySelector('[aria-label="'.concat(t,'"]'))},o=function(e){return e.add(1,"d")};if(6===t.day()){var l=o(t);n(r(l.format("MMMM D, YYYY")),l.date())}else if(e.findIfIsFridayAfterHoursToday()){var d=o(t);n(r(d.format("MMMM D, YYYY")),d.date());var c=o(d);n(r(c.format("MMMM D, YYYY")),c.date())}}),300)}},disableCalendarCells:function(){this.$el.querySelectorAll(".flatpickr-day").forEach((function(e){e.style.pointerEvents="none"}))},styleBufferDays:function(){var e=this.$el.querySelectorAll(".flatpickr-day"),t=this.bookedBufferDates.map((function(e){return e.toString()}));e.forEach((function(e){t.indexOf(e.dateObj.toString())>-1&&e.classList.add("buffered")}))},showBorrowerOnBlockedDays:function(){var e=this.$el.querySelectorAll(".flatpickr-day"),t=this.bookedSlots.map((function(slot){var e=slot.rental_date.date.split(" ")[0],t=slot.rental_end.date.split(" ")[0];return{rental_date:d()(e,"YYYY-MM-DD"),rental_end:d()(t,"YYYY-MM-DD"),label:slot.order_id}}));e.forEach((function(e){var n=t.findIndex((function(slot){return d()(e.dateObj).isBetween(slot.rental_date,slot.rental_end,null,"[]")}));n>-1&&(e.innerHTML+="<br>".concat(t[n].label))}))},isClickOnStartRange:function(e,t){var n=d()(new Date(e)).format("DD-MM-YYYY");return 0===t.indexOf(n)},closeWarningMessage:function(){this.showWarningMessage=!1}},created:function(){var e=this;setTimeout((function(){if(e.value){var t=e.value.dates;e.innerValue=[t[0],t[t.length-1]]}})),this.mounted=!0},mounted:function(){this.mounted=!0,this.styleCurrentWeekendDays()}},O=n(4),component=Object(O.a)(S,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.mounted?n("div",{staticClass:"date-selector new-colors",class:{loading:e.loadingEdit}},[e.showWarningMessage?[n("dw-alert",[n("div",[e._v("\n        We'll need to double-check if these dates give us enough time for the next rental."),n("br"),e._v("\n        Please "),n("a",{staticStyle:{"text-decoration":"underline"},attrs:{href:this.cognitoUrl,target:"_blank"}},[e._v("fill out this quick form")]),e._v(", or call us on (09) 801-2581\n      ")]),e._v(" "),n("dw-icon",{staticClass:"message-close",attrs:{name:"x"},nativeOn:{click:function(t){return e.closeWarningMessage(t)}}})],1)]:e._e(),e._v(" "),n("flat-pickr",{attrs:{placeholder:"Select date",config:e.config,required:!0,"input-class":"date-input",name:"date"},model:{value:e.innerValue,callback:function(t){e.innerValue=t},expression:"innerValue"}})],2):e._e()}),[],!1,null,null,null);t.a=component.exports}}]);